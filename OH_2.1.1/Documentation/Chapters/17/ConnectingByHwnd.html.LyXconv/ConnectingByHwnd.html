<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title></title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="ConnectingByHwnd.tex"> 
<meta name="date" content="2009-11-13 22:57:00"> 
<link rel="stylesheet" type="text/css" href="ConnectingByHwnd.css"> 
</head><body 
>
   <h3 class="sectionHead"><span class="titlemark">0.1. </span> <a 
 id="x1-10000.1"></a>Connecting To A Table By HWND</h3>
<!--l. 23--><p class="noindent" >Version 2.0.0 of OpenHoldem introduced the ability to instruct OpenHoldem to connect
to a poker table by sending a connect message specifying a HWND. As of version 2.1.0,
OpenHoldem also will process messages to disconnect from a window and also to query
what window OpenHoldem is connected to. These functions are useful for automation
reasons and permit you to explicitly control the connection process without having to
display the OpenHoldem attach window. In fact, you can have OpenHoldem hidden
entirely during this process.
<!--l. 32--><p class="indent" >   The following AutoIt script demonstrates how to instruct OpenHoldem to connect to
a window:
<!--l. 35--><p class="indent" >   Example AutoIt Script
   <!--l. 38-->
   <div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-1001r1"></a></span>Global&#x00A0;Const&#x00A0;$WMA_DOCONNECT&#x00A0;=&#x00A0;0x8002&#x00A0;<br /><span class="label"><a 
 id="x1-1002r2"></a></span>Local&#x00A0;$oh_hwnd&#x00A0;=&#x00A0;WinGetHandle("Default&#x00A0;<span 
class="cmsy-10">-</span>&#x00A0;OpenHoldem")&#x00A0;<br /><span class="label"><a 
 id="x1-1003r3"></a></span>Local&#x00A0;$oh_manual_mode&#x00A0;=&#x00A0;WinGetHandle("OpenHoldem&#x00A0;Poker")&#x00A0;<br /><span class="label"><a 
 id="x1-1004r4"></a></span>DllCall("user32.dll",&#x00A0;"lresult",&#x00A0;"SendMessage",&#x00A0;"hwnd",&#x00A0;<br /><span class="label"><a 
 id="x1-1005r5"></a></span>&#x00A0;&#x00A0;&#x00A0;&#x00A0;$oh_hwnd,&#x00A0;"uint",&#x00A0;$WMA_DOCONNECT,&#x00A0;"wparam",&#x00A0;0,&#x00A0;<br /><span class="label"><a 
 id="x1-1006r6"></a></span>&#x00A0;&#x00A0;&#x00A0;&#x00A0;"lparam",&#x00A0;$oh_manual_mode)
   </div>
<!--l. 48--><p class="indent" >   The following AutoIt script demonstrates how to instruct OpenHoldem to disconnect
from a window:
<!--l. 51--><p class="indent" >   Example AutoIt Script
   <!--l. 54-->
   <div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-1007r1"></a></span>Global&#x00A0;Const&#x00A0;$WMA_DODISCONNECT&#x00A0;=&#x00A0;0x8003&#x00A0;<br /><span class="label"><a 
 id="x1-1008r2"></a></span>Local&#x00A0;$oh_hwnd&#x00A0;=&#x00A0;WinGetHandle("Default&#x00A0;<span 
class="cmsy-10">-</span>&#x00A0;OpenHoldem")&#x00A0;<br /><span class="label"><a 
 id="x1-1009r3"></a></span>DllCall("user32.dll",&#x00A0;"lresult",&#x00A0;"SendMessage",&#x00A0;"hwnd",&#x00A0;<br /><span class="label"><a 
 id="x1-1010r4"></a></span>&#x00A0;&#x00A0;&#x00A0;&#x00A0;$oh_hwnd,&#x00A0;"uint",&#x00A0;$WMA_DODISCONNECT,&#x00A0;"wparam",&#x00A0;0,&#x00A0;<br /><span class="label"><a 
 id="x1-1011r5"></a></span>&#x00A0;&#x00A0;&#x00A0;&#x00A0;"lparam",&#x00A0;0)
   </div>
<!--l. 63--><p class="indent" >   The following AutoIt script demonstrates how to query OpenHoldem for the window
that it is connected to:
<!--l. 66--><p class="indent" >   Example AutoIt Script
   <!--l. 69-->
   <div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-1012r1"></a></span>#Include&#x00A0;&#x003C;String.au3&#x003E;&#x00A0;<br /><span class="label"><a 
 id="x1-1013r2"></a></span>Global&#x00A0;Const&#x00A0;$WMA_CONNECTEDHWND&#x00A0;=&#x00A0;0x8004&#x00A0;<br /><span class="label"><a 
 id="x1-1014r3"></a></span>Local&#x00A0;$oh_hwnd&#x00A0;=&#x00A0;WinGetHandle("Default&#x00A0;<span 
class="cmsy-10">-</span>&#x00A0;OpenHoldem")&#x00A0;<br /><span class="label"><a 
 id="x1-1015r4"></a></span>Local&#x00A0;$a&#x00A0;=&#x00A0;DllCall("user32.dll",&#x00A0;"lresult",&#x00A0;"SendMessage",&#x00A0;"hwnd",&#x00A0;<br /><span class="label"><a 
 id="x1-1016r5"></a></span>&#x00A0;&#x00A0;&#x00A0;&#x00A0;$oh_hwnd,&#x00A0;"uint",&#x00A0;$WMA_CONNECTEDHWND,&#x00A0;"wparam",&#x00A0;0,&#x00A0;<br /><span class="label"><a 
 id="x1-1017r6"></a></span>&#x00A0;&#x00A0;&#x00A0;&#x00A0;"lparam",&#x00A0;0)&#x00A0;<br /><span class="label"><a 
 id="x1-1018r7"></a></span>ConsoleWrite("Connected&#x00A0;to:&#x00A0;"&#x00A0;&amp;&#x00A0;Hex($a[0])&#x00A0;&amp;&#x00A0;@CRLF)
   </div>
    
</body></html> 



