<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="http://www.nongnu.org/elyxer/"/>
<meta name="create-date" content="2015-03-29"/>
<link rel="stylesheet" href="http://elyxer.nongnu.org/lyx.css" type="text/css" media="all"/>
<title>Converted document</title>
</head>
<body>
<div id="globalWrapper">
<h1 class="Section">
<a class="toc" name="toc-Section-1"></a><a class="IndexReference" name="entry-Mouse-DLL-0" href="#index-Mouse-DLL">↓</a>Mouse <a class="IndexReference" name="entry-DLL-0" href="#index-DLL">↓</a>DLL<a class="Label" name="sec:Mouse-DLL"> </a> 
</h1>
<div class="Unindented">
The mouse DLL extension provides for a user-specified handling of mouse actions. The standard, reference mouse.dll that is shipped with OpenHoldem performs very un-human-like mouse activities. For example, instantly warping the mouse pointer to a location on the button and clicking is unlikely to be human behavior. A human is more likely to start the mouse moving, accelerate to the target, then decelerate as the pointer nears the position of the button. Simulating mouse movements that are more human-like may help to avoid detection by casions. 
</div>
<div class="Indented">
The mouse DLL extension is available if you would like to implement custom mouse action behavior. The source code for the reference mouse.dll implementation can be found on Google Code in the source code repository.
</div>
<div class="Indented">
Two methods must be exposed in your mouse.dll in order to interface properly with OpenHoldem. 
</div>
<div class="Indented">
“MouseClick” is called when OpenHoldem wants to click a mouse button on a specific location on the screen. The prototype for the “MouseClick” method is:
</div>
<div class="Indented">
<div class="listing">
<pre class="listing">MOUSEDLL_API int MouseClick(const HWND hwnd, const RECT rect, const MouseButton button, const int clicks, const HWND restore_focus, const POINT restore_cursor);
</pre>
</div>

</div>
<div class="Indented">
“MouseClickDrag” is called when OpenHoldem wants to click a mouse button at a specific location on the screen, hold it, drag the cursor to another location, and then release it. Dragging is from rect.left to rect.right, halfway between rect.top and rect.bottom. The prototype for the “MouseClickDrag” method is:
</div>
<div class="Indented">
<div class="listing">
<pre class="listing">MOUSEDLL_API int MouseClickDrag(const HWND hwnd, const RECT rect, const HWND restore_focus, const POINT restore_cursor);
</pre>
</div>

</div>
<div class="Indented">
<table>
<tr>
<td align="left" valign="top" style="width: 20%;">
Parameter
</td>
<td align="left" valign="top" style="width: 80%;">
Description
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
hwnd (in)
</td>
<td align="left" valign="top" style="width: 80%;">
the HWND of the window to take the mouse action on
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
rect (in)
</td>
<td align="left" valign="top" style="width: 80%;">
the bounding rectangle of the area to take action on – this generally corresponds to a Table Map Region record rectangle, like those that define button click areas; this rectangle is in relative client context 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
button (in)
</td>
<td align="left" valign="top" style="width: 80%;">
<div class="PlainVisible">
the mouse button to be clicked, this is an enum:
</div>
<div class="PlainVisible">
<div class="listing">
<pre class="listing"><div class="PlainVisible">
enum MouseButton 
</div>

<div class="PlainVisible">
{ 
</div>

<div class="PlainVisible">
    MouseLeft, 
</div>

<div class="PlainVisible">
    MouseMiddle, 
</div>

<div class="PlainVisible">
    MouseRight 
</div>

<div class="PlainVisible">
}
</div>

</pre>
</div>

</div>

</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
clicks (in) 
</td>
<td align="left" valign="top" style="width: 80%;">
the number of clicks of the specified button 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
restore_focus (in)
</td>
<td align="left" valign="top" style="width: 80%;">
the HWND of the window to return focus, active and foreground to, after the action has been taken; if this is NULL, no focus resotre is requested 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
restore_cursor (in)
</td>
<td align="left" valign="top" style="width: 80%;">
a POINT to return the cursor to, after the action has been taken; if POINT.x and POINT.y are set to -1, then no cursor return is requested 
</td>

</tr>

</table>

</div>

<hr class="footer"/>
<div class="footer" id="generated-by">
Document generated by <a href="http://elyxer.nongnu.org/">eLyXer 1.2.5 (2013-03-10)</a> on <span class="create-date">2015-03-29T22:17:53.859000</span>
</div>
</div>
</body>
</html>
