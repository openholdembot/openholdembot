<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0229)http://webcache.googleusercontent.com/search -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><HTML><HEAD>
<META content="text/html; charset=UTF-8" http-equiv="Content-Type">
<META name="GENERATOR" content="MSHTML 9.00.8112.16476"></HEAD>
<BODY class="mediawiki ns-0 ltr page-Enhanced_Prwin">
<DIV style="background: rgb(255, 255, 255); margin: -1px -1px 0px; padding: 0px; border: 1px solid rgb(153, 153, 153);">
<DIV style="background: rgb(221, 221, 221); font: 13px/normal arial, sans-serif; margin: 12px; padding: 8px; border: 1px solid rgb(153, 153, 153); text-align: left; color: rgb(0, 0, 0); font-size-adjust: none; font-stretch: normal;">This 
is Google's cache of <A style="color: rgb(0, 0, 204); text-decoration: underline;" 
href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;redirect=no">http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;redirect=no</A>. 
It is a snapshot of the page as it appeared on Mar 28, 2013 10:52:36 GMT. The <A 
style="color: rgb(0, 0, 204); text-decoration: underline;" href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;redirect=no">current 
page</A> could have changed in the meantime. <A style="color: rgb(0, 0, 204); text-decoration: underline;" 
href="http://support.google.com/websearch/bin/answer.py?hl=en&amp;p=cached&amp;answer=1687222">Learn 
more</A><BR>Tip: To quickly find your search term on this page, press 
<B>Ctrl+F</B> or <B>⌘-F</B> (Mac) and use the find bar.<BR><BR>
<DIV style="float: right;"><A style="color: rgb(0, 0, 204); text-decoration: underline;" 
href="http://webcache.googleusercontent.com/search?q=cache:PuV7AEdT6FAJ:www.maxinmontreal.com/wiki/index.php5%3Ftitle%3DEnhanced_Prwin%26redirect%3Dno+http://www.maxinmontreal.com/wiki/index.php5/Enhanced_Prwin&amp;hl=en&amp;gl=us&amp;strip=1">Text-only 
version</A></DIV>
<DIV>&nbsp;</DIV></DIV></DIV>
<DIV style="position: relative;">
<META name="keywords" content="Enhanced Prwin,Prw1326,Prwin"><LINK rel="shortcut icon" 
href="/favicon.ico"><LINK title="Maxin Wiki (English)" rel="search" type="application/opensearchdescription+xml" 
href="/wiki/opensearch_desc.php"><TITLE>Enhanced Prwin - Maxin Wiki</TITLE>
<STYLE type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "/wiki/skins/common/shared.css?97";
			@import "/wiki/skins/monobook/main.css?97";
		/*]]>*/</STYLE>
<LINK rel="stylesheet" type="text/css" href="enhanced%20Prwin_files/commonPrint.css" 
media="print"><!--[if lt IE 5.5000]><style type="text/css">@import "/wiki/skins/monobook/IE50Fixes.css?97";</style><![endif]--><!--[if IE 5.5000]><style type="text/css">@import "/wiki/skins/monobook/IE55Fixes.css?97";</style><![endif]--><!--[if IE 6]><style type="text/css">@import "/wiki/skins/monobook/IE60Fixes.css?97";</style><![endif]--><!--[if IE 7]><style type="text/css">@import "/wiki/skins/monobook/IE70Fixes.css?97";</style><![endif]--><!--[if lt IE 7]><script type="text/javascript" src="/wiki/skins/common/IEFixes.js?97"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
<SCRIPT type="text/javascript">/*<![CDATA[*/
var skin = "monobook";
var stylepath = "/wiki/skins";
var wgArticlePath = "/wiki/index.php5/$1";
var wgScriptPath = "/wiki";
var wgScript = "/wiki/index.php5";
var wgServer = "http://www.maxinmontreal.com";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Enhanced_Prwin";
var wgTitle = "Enhanced Prwin";
var wgAction = "view";
var wgRestrictionEdit = [];
var wgRestrictionMove = [];
var wgArticleId = "329";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "en";
var wgContentLanguage = "en";
var wgBreakFrames = false;
var wgCurRevisionId = "1748";
/*]]>*/</SCRIPT>

<SCRIPT type="text/javascript" src="enhanced%20Prwin_files/wikibits.js"><!-- wikibits js --></SCRIPT>

<SCRIPT type="text/javascript" src=""><!-- site js --></SCRIPT>

<STYLE type="text/css">/*<![CDATA[*/
@import "/wiki/index.php5?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "/wiki/index.php5?title=MediaWiki:Monobook.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "/wiki/index.php5?title=-&action=raw&gen=css&maxage=18000";
/*]]>*/</STYLE>
<!-- Head Scripts -->
<SCRIPT type="text/javascript" src="enhanced%20Prwin_files/ajax.js"></SCRIPT>

<DIV id="globalWrapper">
<DIV id="column-content">
<DIV id="content"><A id="top" name="top"></A>
<H1 class="firstHeading">Enhanced Prwin</H1>
<DIV id="bodyContent">
<H3 id="siteSub">From Maxin Wiki</H3>
<DIV id="contentSub"></DIV>
<DIV id="jump-to-nav">Jump to: <A href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;redirect=no#column-one">navigation</A>, 
<A href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;redirect=no#searchInput">search</A></DIV><!-- start content --><A 
name="Overview"></A>
<H2><SPAN class="editsection">[<A title="Edit section: Overview" href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;action=edit&amp;section=1">edit</A>]</SPAN> 
<SPAN class="mw-headline"> Overview </SPAN></H2>
<P>OH <A title="Prwin" 
href="http://www.maxinmontreal.com/wiki/index.php5/Prwin">prwin</A> calculation 
can be switched from its normal table-level weighting calculation to one which 
considers hands likely to be held by individual opponent chairs. This can only 
be activated at dll level using the <A title="Prw1326" href="http://www.maxinmontreal.com/wiki/index.php5/Prw1326">prw1326</A> 
structure whose address is passed to the dll at load time. The mechanism OH uses 
to select opponent cards for each pass of its iterator is, for each active 
opponent, to choose a random number between zero and .limit and use this as an 
index into the chair [1326] arrays. .ranklo and .rankhi are checked to ensure 
that neither of the cards is already in use, if .weight is less than .level 
another random number is used so that the hand will only be selectable 
.weight/.level of the time, and if the hand is available after these tests it is 
assigned for the opponent for that pass of the iterator.</P>
<P>This approach allows the dll coder to implement something very like the 
current OH weighted prwin, but at opponent chair level; to trim the 
probabilities of certain opponent hands as the hand develops; or to switch to an 
approach where only limited handlists are considered for an opponent (possibly 
without any relative weighting). Please bear in mind that with Enhanced Prwin OH 
is completely dependent on you to set up the prw1326 structure, and any errors 
you make will affect the reliability of the result; or cause OH to hang or 
crash. It is not a feature for the novice coder to experiment with.</P><A name="How_to_use_it_from_DLL"></A>
<H2><SPAN class="editsection">[<A title="Edit section: How to use it from DLL" 
href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;action=edit&amp;section=2">edit</A>]</SPAN> 
<SPAN class="mw-headline"> How to use it from DLL </SPAN></H2>
<P>You need to declare the structures and pick up the pointer to them as 
described in <A title="Prw1326" href="http://www.maxinmontreal.com/wiki/index.php5/Prw1326">prw1326</A>. 
To switch OH from its weighted prwin to calculation using data in the structure 
which you have generated you need to set</P>
<P><B>prw1326-&gt;useme = 1326;</B></P>
<P>If this is all you do OH will switch at flop and after to an enhanced 
calculation using the vanilla hand profiles it set up for each chair at 
initialisation. This will probably give slightly worse results than a 
well-configured weighted prwin, since the profiles are static!</P>
<P>Now assume that at the flop you become convinced that chair 2 has a pair of 
aces. No other ace is known, so he can have six possible hands. You want to set 
the structure so that OH only calculates prwin using those hands for that 
opponent. First we need to note how OH (or more specifically the PokerEval 
library) represents cards. Card rank 2 to Ace is represented by 0 to 12. You 
then add a number representing the suit. For hearts add 0, for diamonds add 13, 
for clubs add 26, and for spades add 39. Ac is thus 12+26=38. The six pairs he 
can have are AhAd,AhAc,AhAs,AdAc,AdAs,AcAs. You set the first six positions in 
the [1326] arrays</P><PRE>prw1326-&gt;chair[2].rankhi[0]=12; //Ah
prw1326-&gt;chair[2].ranklo[0]=25; //Ad
 ... etc ... 
prw1326-&gt;chair[2].rankhi[5]=25; //Ad
prw1326-&gt;chair[2].ranklo[5]=51; //As
</PRE>
<P>Since you only want six card pairs to be considered you set 
<B>prw1326-&gt;chair[2].limit=6;</B>Finally you set the weighting for each hand. 
As each hand is considered equally probable:-</P>
<P><B>for(i=0;i&lt;6;i++)prw1326-&gt;chair[2].weight[i]=prw1326-&gt;chair[2].level;</B>
</P>
<P>Once the hand was over you would not want to leave chair 2 as having a pair 
of aces. <B>prw1326-&gt;chair[2]=prw1326-&gt;vanilla_chair;</B> would reset it.
</P>
<P>This was an example of using prw1326 to set an opponent on a handlist. We 
chose a very small list for ease of illustration, but it is worth noting that 
this can be dangerous. If another opponent had a handlist which included a pair 
of aces, and an ace appeared on common, then there would be a risk that OH could 
not find enough cards to satisfy an iteration and would hang. Since the 
iteration process is so cpu intensive we did not include code to catch this 
situation; this can easily be changed if the OH community require it.</P>
<P>Now let us suppose that chair 3 is a tight player. You think he will only 
place money on the upper half of the cards, and will only reliably pay for the 
top 25%. In this case you would want to take the vanilla profile and change the 
weightings on it.</P><PRE>for(i=0;i&lt;332;i++) prw1326-&gt;chair[3].weight[i]=prw1326-&gt;chair[3].level;
for(i=332;i&lt;663;i++) prw1326-&gt;chair[3].weight[i]=prw1326-&gt;chair[3].level*(663-i)/332;
prw1326-&gt;chair[3].limit=663;
</PRE>
<P>Because we have set .limit for the chair we do not need to bother about the 
weightings for the bottom half of the handlist, because they will never be 
considered.</P>
<P>The procedure above would set a general profile for chair 3 based on pre-flop 
behaviour. You might have a situation in which his betting behaviour indicated 
that he might well have a jack in his hand. One response would be to traverse 
the handlist and reduce the weighting for any hand which did not contain a jack. 
A quicker technique is to increase the .level value (which automatically reduced 
the probability for all hands) and then increase the weighting only for hands 
containing a jack. It can be very useful to build up indexes in your dll which 
show the hands which contain aces, kings etc, and also for those which contain 
suited cards. This can speed up this sort of operation considerably.</P>
<P><B>prw1326-&gt;preflop</B></P>
<P>Even if you use prwin at all pre-flop, there are real advantages to using the 
normal OH weighted prwin before the flop. Enhanced prwin works by considering 
specific hand profiles for opponents, and in general pre-flop you are not sure 
who your opponents later on will be. It also does not use P factor to calculate 
against a number of opponents; it works strictly on active opponents. Using 
table tightness and position in an f$P formula to estimate likely number of 
opponents means that weighted prwin is more useful pre-flop. Nevertheless, if 
you set <B>prw1326-&gt;preflop=1326;</B> enhanced prwin will also be used 
pre-flop.</P>
<P><B>prw1326-&gt;bblimp</B></P>
<P>If this is set non-zero then enhanced prwin will not attempt any weighting 
for a chair who has not voluntarily put any money into the pot pre-flop (i.e. an 
unraised BB). Please note that this is <B>not</B> set by default, but is a flag 
which <B>should</B> be set for the prwin calculation to be wholly realistic</P>
<P><B>prw1326-&gt;chair[x].ignore</B></P>
<P>If this is set non-zero then enhanced prwin will not attempt any weighting 
for chair x. The iterator will make no assumptions about the chair handlist. The 
chair itself will still be included in the prwin calculation if it is still 
playing. It is just treated as if it was an unraised BB, so that it could have 
any available hand.</P>
<P><B>CALLBACK</B></P>
<P>There is a mechanism for synchronising your setting of the prw1326 structure 
with the prwin cycle. You can specify a callback function which will be invoked 
immediately before the prwin iteration loop is started. You can use this to copy 
a local structure image over prw1326. Any code here should be short, simple and 
clean. Avoid gws() calls, logging or complex external functions. If you think 
the callback function is a good place to make a couple of hundred PT queries 
then the OH developers reserve the right to be offensively unsympathetic to you. 
<B>You have been warned!</B></P>
<P>If you have callback function in your code of type:</P><PRE>double mycallback(void)
{
//do something here
return 0;
}
</PRE>
<P>then you can set</P><PRE>prw1326-&gt;prw_callback=mycallback;
prw1326-&gt;usecallback=1326;
</PRE>
<P>The return value is not used currently by OH.</P><A name="Notes"></A>
<H2><SPAN class="editsection">[<A title="Edit section: Notes" href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;action=edit&amp;section=3">edit</A>]</SPAN> 
<SPAN class="mw-headline">Notes</SPAN></H2>
<P>The simple minded technique for getting a random number between 0 and X is 
rand()%X. Unfortunately the rand() function returns an integer between 0 and 
32767, and if X is not a sub-multiple of 32768 then the result is biased (only 
slightly if X is not too large). You can code to eliminate this, but in an 
iterated piece of code this introduces an extra cpu load. Currently in prw1326 
we do this elimination on the random numbers used to select the hand from the 
handlist, but not on the .weight / .level assessment since the default .level of 
1024 does not introduce any bias. The effect of an unfortunate choice of .level 
(such as one &gt; 16384) would be to cause hands with a low .weight to be 
over-represented in the calculations. If the OH community feels this can cause a 
problem it can very easily be corrected, at the cost of some cpu load.</P>
<P>If you want to set an opponent on a limited hand list there are two ways you 
can do it with prw1326; you can take a 1326 list and set the weight of the 
unwanted hands to zero, or you can create a sequence of just those hands you are 
interested in and set .limit so that only they are considered. Both will produce 
the same result, but the latter is more cpu-efficient, particularly for a short 
list, since the iterator does not have to waste time rejecting many hands with a 
zero .weight.</P>
<P>When you unload a dll from the OH menu, the .useme and .usecallback flags 
will be cleared but nothing else in the prw1326 structure will be changed. 
Another loaded dll will then find the structure as the previous one left it, so 
you cannot assume the initial OH initialisation unless you do careful 
housekeeping to restore it on dll exit.</P><PRE>  --- work in progress - to be continued ---
</PRE><!-- Saved in parser cache with key maxin_wiki:pcache:idhash:329-0!1!0!!en!2 and timestamp 20130328105236 -->
<DIV class="printfooter">Retrieved from "<A href="http://www.maxinmontreal.com/wiki/index.php5/Enhanced_Prwin">http://www.maxinmontreal.com/wiki/index.php5/Enhanced_Prwin</A>"</DIV><!-- end content -->
<DIV class="visualClear"></DIV></DIV></DIV></DIV>
<DIV id="column-one">
<DIV id="p-cactions" class="portlet">
<H5>Views</H5>
<DIV class="pBody">
<UL>
  <LI id="ca-nstab-main" class="selected"><A accessKey="c" title="View the content page [c]" 
  href="http://www.maxinmontreal.com/wiki/index.php5/Enhanced_Prwin">Article</A></LI>
  <LI id="ca-talk"><A accessKey="t" title="Discussion about the content page [t]" 
  href="http://www.maxinmontreal.com/wiki/index.php5/Talk:Enhanced_Prwin">Discussion</A></LI>
  <LI id="ca-edit"><A accessKey="e" title="You can edit this page. Please use the preview button before saving. [e]" 
  href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;action=edit">Edit</A></LI>
  <LI id="ca-history"><A accessKey="h" title="Past versions of this page. [h]" 
  href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;action=history">History</A></LI></UL></DIV></DIV>
<DIV id="p-personal" class="portlet">
<H5>Personal tools</H5>
<DIV class="pBody">
<UL>
  <LI id="pt-login"><A accessKey="o" title="You are encouraged to log in, it is not mandatory however. [o]" 
  href="http://www.maxinmontreal.com/wiki/index.php5?title=Special:Userlogin&amp;returnto=Enhanced_Prwin">Log 
  in / create account</A></LI></UL></DIV></DIV>
<DIV id="p-logo" class="portlet"><A style='background-image: url("/wiki/skins/common/images/wiki.png");' 
href="http://www.maxinmontreal.com/"></A></DIV>
<SCRIPT type="text/javascript"> if (window.isMSIE55) fixalpha(); </SCRIPT>

<DIV id="p-navigation" class="portlet">
<H5>Navigation</H5>
<DIV class="pBody">
<UL>
  <LI id="n-mainpage"><A accessKey="z" title="Visit the Main Page [z]" href="http://www.maxinmontreal.com/wiki/index.php5/Main_Page">Main 
  Page</A></LI>
  <LI id="n-portal"><A title="About the project, what you can do, where to find things" 
  href="http://www.maxinmontreal.com/wiki/index.php5/Maxin_Wiki:Community_Portal">Community 
  portal</A></LI>
  <LI id="n-currentevents"><A title="Find background information on current events" 
  href="http://www.maxinmontreal.com/wiki/index.php5/Current_events">Current 
  events</A></LI>
  <LI id="n-recentchanges"><A accessKey="r" title="The list of recent changes in the wiki. [r]" 
  href="http://www.maxinmontreal.com/wiki/index.php5/Special:Recentchanges">Recent 
  changes</A></LI>
  <LI id="n-randompage"><A accessKey="x" title="Load a random page [x]" href="http://www.maxinmontreal.com/wiki/index.php5/Special:Random">Random 
  page</A></LI>
  <LI id="n-help"><A title="The place to find out." href="http://www.maxinmontreal.com/wiki/index.php5/Help:Contents">Help</A></LI>
  <LI id="n-sitesupport"><A title="Support us" href="http://www.maxinmontreal.com/wiki/index.php5/Maxin_Wiki:Site_support">Donations</A></LI></UL></DIV></DIV>
<DIV id="p-search" class="portlet">
<H5><LABEL for="searchInput">Search</LABEL></H5>
<DIV id="searchBody" class="pBody">
<FORM id="searchform" action="/wiki/index.php5/Special:Search">
<DIV><INPUT accessKey="f" id="searchInput" title="Search Maxin Wiki [f]" name="search" 
type="text"><INPUT id="searchGoButton" class="searchButton" name="go" value="Go" type="submit">&nbsp;
				<INPUT id="mw-searchButton" class="searchButton" name="fulltext" value="Search" type="submit"></DIV></FORM></DIV></DIV>
<DIV id="p-tb" class="portlet">
<H5>Toolbox</H5>
<DIV class="pBody">
<UL>
  <LI id="t-whatlinkshere"><A accessKey="j" title="List of all wiki pages that link here [j]" 
  href="http://www.maxinmontreal.com/wiki/index.php5/Special:Whatlinkshere/Enhanced_Prwin">What 
  links here</A></LI>
  <LI id="t-recentchangeslinked"><A accessKey="k" title="Recent changes in pages linked from this page [k]" 
  href="http://www.maxinmontreal.com/wiki/index.php5/Special:Recentchangeslinked/Enhanced_Prwin">Related 
  changes</A></LI>
  <LI id="t-upload"><A accessKey="u" title="Upload images or media files [u]" 
  href="http://www.maxinmontreal.com/wiki/index.php5/Special:Upload">Upload 
  file</A></LI>
  <LI id="t-specialpages"><A accessKey="q" title="List of all special pages [q]" 
  href="http://www.maxinmontreal.com/wiki/index.php5/Special:Specialpages">Special 
  pages</A></LI>
  <LI id="t-print"><A accessKey="p" title="Printable version of this page [p]" 
  href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;redirect=no&amp;printable=yes">Printable 
  version</A></LI>
  <LI id="t-permalink"><A title="Permanent link to this version of the page" 
  href="http://www.maxinmontreal.com/wiki/index.php5?title=Enhanced_Prwin&amp;oldid=1748">Permanent 
  link</A></LI></UL></DIV></DIV></DIV><!-- end of the left (by default at least) column -->
<DIV class="visualClear"></DIV>
<DIV id="footer">
<DIV id="f-poweredbyico"><A href="http://www.mediawiki.org/"><IMG alt="Powered by MediaWiki" 
src="enhanced%20Prwin_files/poweredby_mediawiki_88x31.png"></A></DIV>
<UL id="f-list">
  <LI id="lastmod"> This page was last modified 11:35, 18 December 2008.</LI>
  <LI id="viewcount">This page has been accessed 6,105 times.</LI>
  <LI id="privacy"><A title="Maxin Wiki:Privacy policy" href="http://www.maxinmontreal.com/wiki/index.php5/Maxin_Wiki:Privacy_policy">Privacy 
  policy</A></LI>
  <LI id="about"><A title="Maxin Wiki:About" href="http://www.maxinmontreal.com/wiki/index.php5/Maxin_Wiki:About">About 
  Maxin Wiki</A></LI>
  <LI id="disclaimer"><A title="Maxin Wiki:General disclaimer" href="http://www.maxinmontreal.com/wiki/index.php5/Maxin_Wiki:General_disclaimer">Disclaimers</A></LI></UL></DIV>
<SCRIPT type="text/javascript">if (window.runOnloadHook) runOnloadHook();</SCRIPT>
</DIV><!-- Served in 0.134 secs. --></DIV></BODY></HTML>
